---
- name: Get BDOS Flood Profiles from DefensePro devices
  hosts: localhost
  gather_facts: no
  vars_files:
    - ../vars/cc.yml
    - ../vars/get_bdos_vars.yml  # Contains dp_ip Ã— bdos_profiles

  tasks:
    - name: Fetch BDOS Flood Profiles
      get_bdos_profile:
        provider: "{{ provider }}"
        dp_ip: "{{ item.0 }}"
        profile_name: "{{ item.1 }}"
      loop: "{{ dp_ip | product(bdos_mappings) | list }}"
      loop_control:
        label: "{{ item.1 }} on {{ item.0 }}"
      register: bdos_results

    - name: Display BDOS profile info
      debug:
        var: bdos_results.results
