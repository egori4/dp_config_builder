---
# create_vars.yml.example - Template for creating network class variables
# Copy this file to create_vars.yml and customize with your environment details

# Target DefensePro devices - add or remove IP addresses as needed
dp_ip:
  - "10.105.192.32"
  # - "10.105.192.33"
  # - "10.105.192.34"

# Define network classes to create with their network groups
netclasses:
  # Example: Create a network class named "egor_test_net" with 4 network groups
  - name: "egor_test_net"
    groups:
      - { address: "10.10.10.0", mask: "255.255.255.0" }
      - { address: "10.10.11.0", mask: "255.255.255.0" }
      - { address: "10.10.12.0", mask: "255.255.255.0" }
      - { address: "10.10.13.0", mask: "255.255.255.0" }
  
  # Example: Create another network class  
  # - name: "web_servers"
  #   groups:
  #     - { address: "192.168.1.0", mask: "255.255.255.0" }
  #     - { address: "192.168.2.0", mask: "255.255.255.0" }
  
  # Example: Create with CIDR notation
  # - name: "database_servers"  
  #   groups:
  #     - { address: "10.20.1.0", mask: "24" }
  #     - { address: "10.20.2.0", mask: "24" }

# Notes:
# - name: Must be unique network class name
# - address: Network address for each group within the class
# - mask: Can be CIDR notation (e.g., "24") or dotted decimal (e.g., "255.255.255.0")  
# - Groups are automatically assigned indices starting from 0
# - The playbook will create all combinations of dp_ip × netclasses × groups


################################### Connection Limit Profiles ##############################
# Connection Limit Protection Subprofiles (OPTIONAL - only define if you want to create new protections)
# All parameters use user-friendly values that are automatically mapped to API values
# You can skip this entire section if you only want to create profiles using existing protections
cl_protections:
  - name: "cl_prot_tcp_example"
    protection_type: "concurrent_connections"  # Options: cps, concurrent_connections
    protocol: "tcp"             # Options: tcp, udp
    threshold: "100"            # Connection limit threshold (number)
    app_port_group: "https"     # Optional: http, https, dns, ftp, or custom port (leave empty for all ports)
    tracking_type: "src_ip"     # Options: src_ip, dst_ip, src_and_dest_ip, dst_ip_and_port
    action: "drop"              # Options: report_only, drop
    packet_report: "disable"    # Options: enable, disable
    index: 0                    # Optional: specific index to create at (defaults to 0 if not specified = will be allocated dynamically)
  - name: "cl_prot_udp_example"
    protection_type: "cps"      # Options: cps, concurrent_connections
    protocol: "udp"             # Options: tcp, udp
    threshold: "500"            # Connection limit threshold (number)
    app_port_group: ""          # Optional: http, https, dns, ftp, or custom port (leave empty for all ports)
    tracking_type: "dst_ip_and_port"  # Options: src_ip, dst_ip, src_and_dest_ip, dst_ip_and_port
    action: "report_only"       # Options: report_only, drop
    packet_report: "enable"     # Options: enable, disable
    # index: 450006             # Optional: if not specified, defaults to 0
  - name: "cl_prot_custom_index"
    protection_type: "cps"      # Options: cps, concurrent_connections
    protocol: "tcp"             # Options: tcp, udp
    threshold: "200"            # Connection limit threshold (number)
    app_port_group: "http"      # Optional: http, https, dns, ftp, or custom port (leave empty for all ports)
    tracking_type: "dst_ip"     # Options: src_ip, dst_ip, src_and_dest_ip, dst_ip_and_port
    action: "drop"              # Options: report_only, drop
    packet_report: "enable"     # Options: enable, disable
    index: 450007               # Optional: create at specific index 450007

# Parameter Descriptions:
# - protection_type: Type of detection (cps = Connections Per Second, concurrent_connections = Total active connections)
# - protocol: Network protocol to monitor
# - threshold: Number at which protection triggers
# - app_port_group: Application port group to monitor (http, https, dns, ftp, custom port, or empty for all ports)
# - tracking_type: What traffic to track (src_ip, dst_ip, both IPs, or dst_ip with port)
# - action: What to do when threshold exceeded (report_only = log only, drop = block traffic)
# - packet_report: Whether to enable detailed packet reporting
# - index: Optional specific index to create protection at (defaults to 0 if not specified)

# Connection Limit Profiles (OPTIONAL - only define if you want to create profiles)
# Can reference any protection names - existing or newly created above
# You can skip this entire section if you only want to create protections
cl_profiles:
  - name: "cl_prof_example"
    protections:
      - "cl_prot_tcp_example"   # Will be created above
      - "cl_prot_udp_example"   # Will be created above
  - name: "cl_prof_existing_only"
    protections:
      - "some_existing_protection"    # Reference existing protections without defining them

# Usage Scenarios:
# 1. Create protections only: Define cl_protections, skip cl_profiles
# 2. Create profiles only: Skip cl_protections, define cl_profiles with existing protection names
# 3. Create both: Define both cl_protections and cl_profiles


########################## BDoS Profiles ##########################
# Define BDOS profiles to create on each device
# All parameters use user-friendly values that are automatically mapped to API values
# You can skip this section if you only want to use existing BDoS profiles
<<<<<<< HEAD
```yml
=======

>>>>>>> bdos_Egor_v0.1.3_from_Rahul
bdos_profiles:
  - name: "BDOS_Profile_50"
    params:
      action: "report_only"                   # Options: report_only, block_and_report
      syn_flood: "enable"                     # Options: enable, disable
      udp_flood: "enable"                     # Options: enable, disable
      igmp_flood: "enable"                    # Options: enable, disable
      icmp_flood: "enable"                    # Options: enable, disable
      tcp_ack_fin_flood: "enable"             # Options: enable, disable
      tcp_rst_flood: "enable"                 # Options: enable, disable
      tcp_syn_ack_flood: "enable"             # Options: enable, disable
      tcp_frag_flood: "enable"                # Options: enable, disable
      udp_frag_flood: "enable"                # Options: enable, disable
      inbound_traffic: 1000000                # 1 to 1342177280 (kbps)
      outbound_traffic: 500000                # 1 to 1342177280 (kbps)
      tcp_in_quota: 80                         # 0-100 (%)
      udp_in_quota: 50                         # 0-100 (%)
      icmp_in_quota: 10                        # 0-100 (%)
      igmp_in_quota: 50                        # 0-100 (%)
      tcp_out_quota: 80                        # 0-100 (%)
      udp_out_quota: 50                        # 0-100 (%)
      icmp_out_quota: 10                        # 0-100 (%)
      igmp_out_quota: 50                        # 0-100 (%)
      transparent_optimization: "enable"       # Options: enable, disable
      packet_report: "enable"                  # Options: enable, disable
      burst_attack: "enable"                   # Options: enable, disable
      maximum_interval_between_bursts: 32      # Minutes (1-336)
      learning_suppression_threshold: 10       # 0-50
      footprint_strictness: "medium"           # Options: low, medium, high
      udp_packet_rate_detection_sensitivity: "low"  # Options: Ignore_or_Disable, low, medium, high
      bdos_rate_limit: "user_defined"          # Options: disable, normal_edge, suspect_edge, user_defined
      user_defined_rate_limit: 500             # 0-4000 (rate value)
      user_defined_rate_limit_unit: "mbps"     # Options: kbps, mbps, gbps
      adv_udp_detection: "enable"              # Options: enable, disable
<<<<<<< HEAD
```
=======

>>>>>>> bdos_Egor_v0.1.3_from_Rahul
# Parameter Descriptions:
# - action: What to do when a flood is detected
# - *_flood: Enable/disable detection of specific attack type
# - inbound_traffic / outbound_traffic: Max traffic allowed (bps)
# - *_in_quota / *_out_quota: Traffic quota per protocol (%)
# - transparent_optimization: Optimize traffic without blocking
# - packet_report: Enable detailed packet reporting
# - burst_attack: Detect burst attacks
# - maximum_interval_between_bursts: Interval in minutes to define burst
# - learning_suppression_threshold: Suppress alerts during learning (0-50)
# - footprint_strictness: Sensitivity of footprint analysis
# - udp_packet_rate_detection_sensitivity: Sensitivity of UDP flood detection
# - bdos_rate_limit: Rate limit mode
# - user_defined_rate_limit / unit: Custom rate limit
# - adv_udp_detection: Advanced UDP detection toggle

# Usage Scenarios:
# 1. Create new BDoS profiles: Define bdos_profiles
# 2. Use existing BDoS profiles only: Skip this section and reference them elsewhere


################################## DNS Profile create Variables ###############################
# Define DNS profiles to create on each device
# All parameters use user-friendly values that are automatically mapped to API values
# You can skip this section if you only want to use existing DNS profiles
```yml
dns_profiles:
  # Example: Edit DNS profile "DNS_Profile_50", changing multiple parameters
  - name: "DNS_Profile_50"                 # Mandatory: exact name of the profile to edit
    action: "block_and_report"             # Options: report_only, block_and_report
    expected_qps: 5000                      # 1 to 4000000
    max_allow_qps: 10000                    # 1 to 4000000
    manual_trigger: "disable"               # Options: enable, disable
    manual_trigger_act_thresh: 1000
    manual_trigger_term_thresh: 0
    manual_trigger_max_qps_target: 0
    packet_report: "enable"                # Options: enable, disable
    packet_trace: "disable"                # Options: enable, disable
    footprint_strictness: "high"           # Options: low, medium, high
    learning_suppression_threshold: 20     # 0–50
    query_name_sensitivity: "medium"       # Options: low, medium, high
    subdomains_wl_learning: "enable"       # Options: enable, disable

    # Quotas and status toggles
    a_quota: 50                             # 0–100 (%)
    mx_quota: 30
    ptr_quota: 20
    aaaa_quota: 25
    text_quota: 15
    soa_quota: 10
    naptr_quota: 5
    srv_quota: 5
    other_quota: 5

    a_status: "enable"                      # Options: enable, disable
    mx_status: "disable"
    ptr_status: "enable"
    aaaa_status: "enable"
    text_status: "disable"
    soa_status: "enable"
    naptr_status: "disable"
    srv_status: "enable"
    other_status: "disable"

  # Example: Minimal update for another DNS profile
  # - name: "DNS_Profile_75"
  #   action: "report_only"
  #   expected_qps: 2000
```
### Parameter Descriptions:
# - action: What to do when DNS traffic anomaly is detected
# - expected_qps / max_allow_qps: Thresholds for query rates
# - manual_trigger and related fields: Enable manual override and thresholds
# - packet_report / packet_trace: Enable detailed reporting and tracing
# - footprint_strictness: Sensitivity of footprint analysis
# - learning_suppression_threshold: Suppress alerts during learning (0-50)
# - query_name_sensitivity: Sensitivity of query name monitoring
# - subdomains_wl_learning: Enable/disable learning for subdomains
# - *_quota: Percentage allocation per DNS record type
# - *_status: Enable/disable monitoring per DNS record type

# Usage Scenarios:
# 1. Create new DNS profiles: Define dns_profiles
# 2. Use existing DNS profiles only: Skip this section and reference them elsewhere

################################## OOS/Stateful Profile Create Variables ###############################
# Define OOS profiles to create on each device
# All parameters use user-friendly values that are automatically mapped to API values
# You can skip this section if you only want to use existing OOS profiles

oos_profiles:
  # Example: Create OOS profile "oos_profile_50" with multiple parameters
  - name: "oos_profile_50"                  # Mandatory: exact profile name
    params:
    action: "block_and_report"              # Options: report_only, block_and_report
    syn_ack_allow: "enable"                 # Options: enable, disable
    packet_report: "enable"                 # Options: enable, disable
    risk: "high"                            # Options: low, medium, high
    idle_state: "enable"                    # Options: enable, disable
    idle_state_bandwidth_threshold: 1000    # Optional numeric threshold
    idle_state_timer: 60                     # Optional numeric threshold
    act_threshold: 2000                      # Optional numeric threshold
    term_threshold: 1000                     # Optional numeric threshold

  # Example: Minimal creation with only mandatory name
  - name: "oos_profile_51"
    # All other parameters use defaults

  #Parameter Descriptions for OOS/Stateful Profiles:
         name: Mandatory – unique profile name
         action: What to do when an anomaly is detected (report_only / block_and_report)
         syn_ack_allow: Enable/disable SYN-ACK allowance
         packet_report: Enable/disable detailed reporting
         idle_state: Enable/disable idle state monitoring
         idle_state_bandwidth_threshold: Bandwidth threshold for idle state (numeric)
         idle_state_timer: Idle state timer in seconds (numeric)
         act_threshold / term_threshold: Traffic thresholds 

## Usage Scenarios:
   # Create new OOS profiles: Define oos_profiles as above
   # Use existing OOS profiles only: Skip this section and reference them in edit/delete playbooks
